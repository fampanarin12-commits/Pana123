<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ - ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #800000;
            --accent: #ffc107;
            --danger: #dc3545;
            --success: #28a745;
            --bg: #f8f9fa;
        }

        body { font-family: 'Sarabun', sans-serif; background-color: var(--bg); margin: 0; padding-bottom: 100px; }
        
        .header-section { 
            background: linear-gradient(135deg, #800000 0%, #4a0000 100%); 
            color: white; 
            padding: 60px 20px 100px; 
            text-align: center; 
            border-radius: 0 0 50px 50px; 
            position: relative;
        }

        .logout-container {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .btn-logout {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.4);
            padding: 8px 15px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            font-family: 'Sarabun', sans-serif;
            backdrop-filter: blur(5px);
            transition: 0.3s;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
        }

        .btn-logout:hover {
            background: var(--danger);
            border-color: var(--danger);
            transform: scale(1.05);
        }

        .container { max-width: 800px; margin: -60px auto 0; padding: 0 20px; }
        
        .user-card { 
            background: white; 
            padding: 15px 25px; 
            border-radius: 20px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); 
            margin-bottom: 30px; 
            display: flex;
            align-items: center;
        }
        
        .shop-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 40px; }
        .shop-item { background: white; border-radius: 20px; overflow: hidden; cursor: pointer; transition: 0.3s; box-shadow: 0 5px 15px rgba(0,0,0,0.05); text-align: center; border: 3px solid transparent; }
        .shop-item.active { border-color: var(--primary); background: #fff8f8; transform: translateY(-3px); }
        .shop-img-container { height: 110px; background: #eee; display: flex; align-items: center; justify-content: center; font-size: 40px; }
        .shop-img-container img { width: 100%; height: 100%; object-fit: cover; }
        .shop-name { padding: 10px; font-weight: bold; }

        .card { 
            background: white; padding: 15px 20px; border-radius: 18px; 
            margin-bottom: 12px; display: flex; justify-content: space-between; 
            align-items: center; box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            border-left: 6px solid var(--primary);
        }
        .menu-info { flex: 1; display: flex; align-items: center; gap: 15px; }
        .menu-name { font-weight: bold; }
        .menu-price { color: var(--primary); font-weight: bold; background: #fff0f0; padding: 2px 8px; border-radius: 8px; }

        .quantity-control { 
            display: flex; align-items: center; gap: 10px; 
            background: #f8f9fa; padding: 5px 12px; border-radius: 12px;
            border: 1px solid #eee;
        }
        .btn-qty { 
            width: 30px; height: 30px; border-radius: 8px; border: 1px solid #ddd;
            background: white; cursor: pointer; font-weight: bold; font-size: 18px;
            display: flex; align-items: center; justify-content: center;
            transition: 0.2s;
        }
        .btn-qty:hover { background: var(--primary); color: white; border-color: var(--primary); }
        .qty-val { font-weight: bold; min-width: 20px; text-align: center; }

        .cart-section { background: white; padding: 25px; border-radius: 25px; margin-top: 30px; border-top: 5px solid var(--accent); box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px dashed #ddd; }
        .btn-submit { width: 100%; padding: 18px; background: var(--success); color: white; border: none; border-radius: 18px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 20px; }

        .fab-bill { position: fixed; bottom: 25px; right: 25px; width: 75px; height: 75px; background: var(--primary); color: white; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 8px 25px rgba(0,0,0,0.3); cursor: pointer; z-index: 1000; border: 3px solid var(--accent); transition: transform 0.2s; }
        .fab-bill:active { transform: scale(0.9); }
        
        .notify-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            display: none; 
        }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2000; backdrop-filter: blur(5px); }
        .modal-content { background: white; width: 90%; max-width: 500px; margin: 40px auto; border-radius: 30px; padding: 25px; max-height: 80vh; overflow-y: auto; }
        
        .bill-card { border: 1px solid #eee; border-radius: 20px; padding: 18px; margin-bottom: 15px; border-left: 5px solid var(--accent); position: relative; transition: 0.3s; }
        
        .status-tag { padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; float: right; }
        .status-wait { background: #fff3cd; color: #856404; border: 1px solid #ffeeba; }
        .status-done { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .status-cancel { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        
        .btn-cancel-order { background: #fff; color: var(--danger); border: 1px solid var(--danger); padding: 6px 14px; border-radius: 10px; font-size: 13px; cursor: pointer; font-weight: bold; margin-top: 10px; }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ */
        .btn-delete-history { 
            background: #f1f1f1; 
            border: none; 
            cursor: pointer; 
            font-size: 16px; 
            float: right; 
            margin-right: 10px; 
            padding: 5px 8px;
            border-radius: 8px;
            transition: 0.2s;
        }
        .btn-delete-history:hover { background: #fee; color: var(--danger); }
    </style>
</head>
<body>

    <div class="header-section">
        <div class="logout-container">
            <a href="index.html" class="btn-logout">üèÉ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
        </div>
        <h2>‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á</h2>
        <p>‡∏£‡∏™‡∏ä‡∏≤‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡πâ‡∏ô‡πÄ‡∏Ñ‡∏¢ ‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
    </div>

    <div class="container">
        <div class="user-card">
            <span>üë§ ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ, <b id="displayUser"></b></span>
        </div>

        <h3 style="color:#444;">üìç ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h3>
        <div id="shopGrid" class="shop-grid"></div>

        <div id="menuDisplay">
            <p style="text-align:center; color:#999; padding:40px; background:#fff; border-radius:20px;">üè† ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏±‡πà‡∏á</p>
        </div>

        <div id="cartBox" style="display:none;" class="cart-section">
            <h3 style="margin-top:0;">üõí ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</h3>
            <div id="cartDisplay"></div>
            <div style="text-align:right; font-size:20px; margin-top:20px; border-top:2px solid #f8f9fa; padding-top:15px;">
                ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <b id="totalPrice" style="color:var(--primary); font-size:28px;">0</b> ‡∏ö‡∏≤‡∏ó
            </div>
            <button class="btn-submit" onclick="submitOrder()">üöÄ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</button>
        </div>
    </div>

    <div class="fab-bill" onclick="showMyBills()">
        <span id="billBadge" class="notify-badge">0</span>
        <div style="font-size: 26px;">üßæ</div>
        <span style="font-size: 11px; font-weight: bold;">‡∏ö‡∏¥‡∏•‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</span>
    </div>

    <div id="billModal" class="modal">
        <div class="modal-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h3 style="margin:0;">üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</h3>
                <span style="cursor:pointer; font-size:30px; color:#999;" onclick="closeModal()">&times;</span>
            </div>
            <div id="billHistoryList"></div>
        </div>
    </div>

    <script>
        document.getElementById('displayUser').innerText = sessionStorage.getItem('currentUser') || 'Guest';
        let cart = [];
        let currentSelectedShop = "";

        function loadShops() {
            const shops = JSON.parse(localStorage.getItem('shops')) || [];
            const grid = document.getElementById('shopGrid');
            grid.innerHTML = shops.map(shop => `
                <div class="shop-item" onclick="selectShop(this, '${shop.name}')">
                    <div class="shop-img-container">${shop.img ? `<img src="${shop.img}">` : 'üç≥'}</div>
                    <div class="shop-name">${shop.name}</div>
                </div>
            `).join('');
        }

        function selectShop(el, name) {
            document.querySelectorAll('.shop-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
            currentSelectedShop = name;
            loadMenus();
        }

        function loadMenus() {
            const allMenus = JSON.parse(localStorage.getItem('menus')) || [];
            const filtered = allMenus.filter(m => m.shop === currentSelectedShop);
            const display = document.getElementById('menuDisplay');
            
            display.innerHTML = `<h4 style="margin:10px 0 15px 5px; color:var(--primary);">üç¥ ‡πÄ‡∏°‡∏ô‡∏π‡∏£‡πâ‡∏≤‡∏ô: ${currentSelectedShop}</h4>` + 
                (filtered.length ? filtered.map((item, index) => {
                    const inCart = cart.find(c => c.name === item.name && c.shop === currentSelectedShop);
                    const currentQty = inCart ? inCart.quantity : 0;

                    return `
                    <div class="card">
                        <div class="menu-info">
                            <span class="menu-name">${item.name}</span>
                            <span class="menu-price">${item.price}.-</span>
                        </div>
                        <div class="quantity-control">
                            <button class="btn-qty" onclick="updateItemQty('${item.name}', ${item.price}, -1)">-</button>
                            <span class="qty-val" id="qty-${currentSelectedShop}-${item.name}">${currentQty}</span>
                            <button class="btn-qty" onclick="updateItemQty('${item.name}', ${item.price}, 1)">+</button>
                        </div>
                    </div>`;
                }).join('') : '<p style="text-align:center; color:#999;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏°‡∏ô‡∏π</p>');
        }

        function updateItemQty(name, price, delta) {
            const idx = cart.findIndex(i => i.name === name && i.shop === currentSelectedShop);
            if (idx > -1) {
                cart[idx].quantity += delta;
                if (cart[idx].quantity <= 0) cart.splice(idx, 1);
            } else if (delta > 0) {
                cart.push({ name, price, shop: currentSelectedShop, quantity: 1 });
            }
            const qtyElement = document.getElementById(`qty-${currentSelectedShop}-${name}`);
            const currentItem = cart.find(i => i.name === name && i.shop === currentSelectedShop);
            if (qtyElement) qtyElement.innerText = currentItem ? currentItem.quantity : 0;
            updateCartUI();
        }

        function updateCartUI() {
            const box = document.getElementById('cartBox');
            const display = document.getElementById('cartDisplay');
            if (cart.length === 0) { box.style.display = 'none'; return; }
            box.style.display = 'block';

            display.innerHTML = cart.map((item, idx) => `
                <div class="cart-item">
                    <div style="flex:1;">
                        <b style="font-size:16px;">${item.name}</b><br>
                        <small style="color:#666;">${item.shop}</small>
                    </div>
                    <div style="font-weight:bold; color:var(--primary); margin-right:15px;">
                        ${item.quantity} x ${item.price} = ${item.price * item.quantity}.-
                    </div>
                    <button onclick="removeItem(${idx})" style="background:none; border:none; color:red; cursor:pointer;">üóëÔ∏è</button>
                </div>
            `).join('');
            document.getElementById('totalPrice').innerText = cart.reduce((s, i) => s + (i.price * i.quantity), 0);
        }

        function removeItem(idx) {
            const item = cart[idx];
            cart.splice(idx, 1);
            const qtyElement = document.getElementById(`qty-${item.shop}-${item.name}`);
            if (qtyElement) qtyElement.innerText = 0;
            updateCartUI();
        }

        function submitOrder() {
            if(!cart.length) return;
            const orders = JSON.parse(localStorage.getItem('orders')) || [];
            const newOrder = {
                id: "ORD-" + Date.now(),
                customer: sessionStorage.getItem('currentUser') || 'Guest',
                shop: currentSelectedShop,
                items: [...cart],
                total: cart.reduce((s, i) => s + (i.price * i.quantity), 0),
                status: '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                time: new Date().toLocaleTimeString('th-TH'),
                date: new Date().toLocaleDateString('th-TH')
            };
            orders.push(newOrder);
            localStorage.setItem('orders', JSON.stringify(orders));
            alert('üöÄ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
            cart = [];
            updateCartUI();
            loadMenus();
            showMyBills();
            updateBillBadge();
        }

        function updateBillBadge() {
            const myUser = sessionStorage.getItem('currentUser');
            const allOrders = JSON.parse(localStorage.getItem('orders')) || [];
            const activeCount = allOrders.filter(o => 
                o.customer === myUser && (o.status === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' || o.status === '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô')
            ).length;
            
            const badge = document.getElementById('billBadge');
            if (activeCount > 0) {
                badge.style.display = 'flex';
                badge.innerText = activeCount;
            } else {
                badge.style.display = 'none';
            }
        }

        function cancelOrder(orderId) {
            if(!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å?')) return;
            let orders = JSON.parse(localStorage.getItem('orders')) || [];
            const idx = orders.findIndex(o => o.id === orderId);
            if (idx > -1 && orders[idx].status === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£') {
                orders[idx].status = '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß';
                localStorage.setItem('orders', JSON.stringify(orders));
                renderBillList();
                updateBillBadge();
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å LocalStorage
        function deleteBill(orderId) {
            if(!confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ö‡∏¥‡∏•‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) return;
            let orders = JSON.parse(localStorage.getItem('orders')) || [];
            orders = orders.filter(o => o.id !== orderId);
            localStorage.setItem('orders', JSON.stringify(orders));
            renderBillList();
            updateBillBadge();
        }

        function showMyBills() {
            document.getElementById('billModal').style.display = 'block';
            renderBillList();
        }

        function renderBillList() {
            const myUser = sessionStorage.getItem('currentUser');
            const allOrders = JSON.parse(localStorage.getItem('orders')) || [];
            const myOrders = allOrders.filter(o => o.customer === myUser);
            const listDiv = document.getElementById('billHistoryList');

            if (!myOrders.length) {
                listDiv.innerHTML = '<p style="text-align:center; color:#999; margin:30px;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>';
                return;
            }

            listDiv.innerHTML = [...myOrders].reverse().map(o => {
                const isFinalStatus = (o.status === '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô' || o.status === '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß' || o.status === '‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß');
                let statusIcon = o.status === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' ? '‚è≥' : (o.status === '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô' || o.status === '‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß' ? '‚úÖ' : '‚ùå');

                return `
                <div class="bill-card" style="${o.status === '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß' ? 'opacity:0.7;' : ''}">
                    <span class="status-tag ${o.status === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' ? 'status-wait' : (o.status === '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß' ? 'status-cancel' : 'status-done')}">
                        ${statusIcon} ${o.status}
                    </span>
                    
                    ${isFinalStatus ? `<button class="btn-delete-history" title="‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥" onclick="deleteBill('${o.id}')">üóëÔ∏è</button>` : ''}
                    
                    <strong>üè™ ‡∏£‡πâ‡∏≤‡∏ô: ${o.shop}</strong><br>
                    <small style="color:#666;">üìÖ ${o.date} | ‚è∞ ${o.time}</small>
                    <div style="margin:10px 0; font-size:15px; color:#333; padding:10px; background:#f9f9f9; border-radius:10px;">
                        ${o.items.map(i => `
                            <div style="display:flex; justify-content:space-between;">
                                <span>${i.name} x${i.quantity}</span>
                                <span>${i.price * i.quantity}.-</span>
                            </div>
                        `).join('')}
                    </div>
                    <div style="display:flex; justify-content:space-between; align-items:center; border-top:1px solid #eee; padding-top:10px;">
                        <span>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</span>
                        <b style="font-size:20px; color:var(--primary);">‡∏ø${o.total}</b>
                    </div>
                    ${o.status === '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' ? `<button class="btn-cancel-order" onclick="cancelOrder('${o.id}')">‚ùå ‡∏Ç‡∏≠‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>` : ''}
                </div>`;
            }).join('');
        }

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        setInterval(() => {
            updateBillBadge();
            if (document.getElementById('billModal').style.display === 'block') {
                renderBillList();
            }
        }, 3000);

        function closeModal() { document.getElementById('billModal').style.display = 'none'; }
        window.onclick = (e) => { if(e.target.id === 'billModal') closeModal(); }

        loadShops();
        updateBillBadge();
    </script>
</body>
</html>